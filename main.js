!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},r=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)},n=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?o(t,r):a(t,r)},o=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},a=(e,t)=>{e.disabled=!1,e.classList.remove(t.inactiveButtonClass)};var s=e+"d3610e9c6dce3cb370d8.svg",c=e+"03fcfd6582f118f2d4fa.svg",l=e+"5d3f137969685e5485dd.svg",d=e+"dba18798529f242c4c6d.svg",i=e+"d73f076c46eb5467f5fc.svg";function u(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Save",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Saving...";e.textContent=t?n:r}document.getElementById("header__logo").src=s;const m=document.getElementById("profile__avatar");document.getElementById("profile__edit-btn-icon").src=c,document.getElementById("profile__add-btn-icon").src=l,document.getElementById("modal__close-btn-icon").src=d,document.getElementById("profile__avatar-btn-img").src=i,document.getElementById("modal__close-btn-icon-2").src=d,document.getElementById("modal__close-btn-icon-3").src=d;const _=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}: ${e.statusText}`)}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then(this._checkResponse)}editUserAvatar(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}changeLikeStatus(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then(this._checkResponse)}editUserPost(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then(this._checkResponse)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"9cb02ddb-be93-4f4d-acd7-bf55d0ac90f0","Content-Type":"application/json"}});_.getAppInfo().then((e=>{let[t,r]=e;t.forEach((e=>{const t=M(e);B.prepend(t)}));const{name:n,about:o,avatar:a}=r;v.textContent=n,b.textContent=o,m.src=a})).catch((e=>{console.log(e)}));const h=document.querySelector(".profile__edit-btn"),f=document.querySelector(".profile__add-btn"),v=document.querySelector(".profile__name"),b=document.querySelector(".profile__description"),p=document.querySelector("#edit-modal"),y=p.querySelector(".modal__form"),S=y.elements["profile-name-input"],E=y.elements["profile-description-input"],g=document.querySelector(".profile__avatar-btn"),k=document.querySelector("#add-card-modal"),q=k.querySelector(".modal__form"),L=q.elements["add-card-name-input"],C=q.elements["add-card-link-input"],U=k.querySelector(".modal__submit-btn"),I=document.querySelector("#card-template"),B=document.querySelector(".cards__list"),$=document.querySelector("#preview-modal"),x=$.querySelector(".modal__image"),A=$.querySelector(".modal__caption"),D=document.querySelector("#avatar-modal"),P=D.querySelector(".modal__form"),R=D.querySelector("#profile-avatar-input"),T=document.querySelector("#delete-modal"),w=T.querySelector(".modal__form"),N=T.querySelector(".modal__submit-btn_cancel");let O,j;function J(e){e.classList.add("modal_opened"),document.addEventListener("keydown",z)}function H(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",z)}function z(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&H(e)}}function M(e){const t=I.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),n=t.querySelector(".card__image"),o=t.querySelector(".card__like-btn"),a=t.querySelector(".card__delete-btn");return r.textContent=e.name,n.alt=e.name,n.src=e.link,e.isLiked&&o.classList.add("card__like-btn_liked"),o.addEventListener("click",(t=>{!function(e,t){const r=e.target,n=r.classList.contains("card__like-btn_liked");_.changeLikeStatus(t,n).then((()=>{r.classList.toggle("card__like-btn_liked")})).catch((e=>{console.error("Error handling like:",e)}))}(t,e._id)})),a.addEventListener("click",(()=>{!function(e,t){O=e,j=t,J(T)}(t,e._id)})),n.addEventListener("click",(()=>{J($),x.src=e.link,x.alt=e.name,A.textContent=e.name})),t}var F;document.querySelectorAll(".modal__close-btn").forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>H(t)))})),document.querySelectorAll(".modal").forEach((e=>{e.addEventListener("mousedown",(t=>{t.target.classList.contains("modal_opened")&&H(e)}))})),h.addEventListener("click",(()=>{var e,n;S.value=v.textContent,E.value=b.textContent,J(p),e=y,n=t,[S,E].forEach((t=>{r(e,t,n)}))})),f.addEventListener("click",(()=>{J(k)})),y.addEventListener("submit",(function(e){const t=e.submitter;u(t,!0),e.preventDefault(),_.editUserInfo({name:S.value,about:E.value}).then((e=>{v.textContent=e.name,b.textContent=e.about,H(p)})).catch(console.error).finally((()=>{u(t,!1)}))})),q.addEventListener("submit",(function(e){e.preventDefault();const r=e.submitter;u(r,!0);const n={name:L.value,link:C.value};_.editUserPost(n).then((e=>{const r=M(e);B.prepend(r),H(k),q.reset(),o(U,t)})).catch(console.error).finally((()=>{u(r,!1)}))})),g.addEventListener("click",(()=>{J(D)})),P.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;u(t,!0),_.editUserAvatar({avatar:R.value}).then((e=>{m.src=e.avatar,H(D)})).catch(console.error).finally((()=>{u(t,!1)}))})),w.addEventListener("submit",(function(e){const t=e.submitter;u(t,!0,"Delete","Deleting..."),e.preventDefault(),_.deleteCard(j).then((()=>{O.remove(),H(T)})).catch(console.error).finally((()=>{u(t,!1,"Delete","Deleting...")}))})),N.addEventListener("click",(()=>{H(T)})),F=t,document.querySelectorAll(F.formSelector).forEach((e=>{((e,t)=>{const o=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);a?(n(o,a,t),o.forEach((s=>{s.addEventListener("input",(()=>{((e,t,n)=>{t.validity.valid?r(e,t,n):((e,t,r,n)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(n.inputErrorClass)})(e,t,t.validationMessage,n)})(e,s,t),n(o,a,t)}))}))):console.error("Submit button not found in form:",e)})(e,F)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVltSixNQUFNQyxLQUFLN0osRUFBTzhJLGlCQUFpQjVJLEVBQU9SLGdCQUN0RG9LLEVBQWdCOUosRUFBT0csY0FBY0QsRUFBT1Asc0JBRzdDbUssR0FNTHRKLEVBQWtCQyxFQUFXcUosRUFBZTVKLEdBRzVDTyxFQUFVd0UsU0FBUzhFLElBQ2pCQSxFQUFhdkMsaUJBQWlCLFNBQVMsS0F0RGhCd0MsRUFBQ2hLLEVBQVFDLEVBQVNDLEtBQ3RDRCxFQUFRWSxTQUFTQyxNQUdwQmYsRUFBZUMsRUFBUUMsRUFBU0MsR0FoQmIrSixFQUFDakssRUFBUUMsRUFBU2lLLEVBQVVoSyxLQUM5QkYsRUFBT0csY0FBYyxJQUFJRixFQUFRRyxZQUN6Q0MsWUFBYzZKLEVBQ3pCakssRUFBUUssVUFBVWEsSUFBSWpCLEVBQU9MLGdCQUFnQixFQVczQ29LLENBQWVqSyxFQUFRQyxFQUFTQSxFQUFRa0ssa0JBQW1CakssRUFHN0QsRUFrREk4SixDQUFtQmhLLEVBQVErSixFQUFjN0osR0FDekNNLEVBQWtCQyxFQUFXcUosRUFBZTVKLEVBQU8sR0FDbkQsS0FaRnlGLFFBQVE4QyxNQUFNLG1DQUFvQ3pJLEVBYWxELEVBT0EySixDQUFrQjNKLEVBQVFFLEVBQU8sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL0FwaS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ0blwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnRuX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvclwiLFxufTtcblxuLy8gVXRpbGl0eSBGdW5jdGlvbnMgZm9yIElucHV0IEVycm9yIEhhbmRsaW5nXG5cbmNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCwgZXJyb3JNc2csIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBlcnJvck1zZztcbiAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xufTtcblxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcbiAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICBlcnJvck1zZ0VsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xufTtcblxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKSA9PiB7XG4gIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xuICAgIHNob3dJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSwgY29uZmlnKTtcbiAgfSBlbHNlIHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGNvbmZpZyk7XG4gIH1cbn07XG5cbi8vIEZvcm0gVmFsaWRhdGlvbiBTdGF0ZSBGdW5jdGlvbnNcbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcbiAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dCkgPT4gIWlucHV0LnZhbGlkaXR5LnZhbGlkKTtcbn07XG5cbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uRWwsIGNvbmZpZykgPT4ge1xuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsLCBjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGVuYWJsZUJ1dHRvbihidXR0b25FbCwgY29uZmlnKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWwsIGNvbmZpZykgPT4ge1xuICBidXR0b25FbC5kaXNhYmxlZCA9IHRydWU7XG4gIGJ1dHRvbkVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xufTtcblxuY29uc3QgZW5hYmxlQnV0dG9uID0gKGJ1dHRvbkVsLCBjb25maWcpID0+IHtcbiAgYnV0dG9uRWwuZGlzYWJsZWQgPSBmYWxzZTtcbiAgYnV0dG9uRWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG59O1xuXG4vLyBSZXNldCBGb3JtIFZhbGlkYXRpb25cbmV4cG9ydCBjb25zdCByZXNldFZhbGlkYXRpb24gPSAoZm9ybUVsLCBpbnB1dExpc3QsIGNvbmZpZykgPT4ge1xuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0LCBjb25maWcpO1xuICB9KTtcbn07XG5cbi8vIEV2ZW50IExpc3RlbmVycyBhbmQgRm9ybSBJbml0aWFsaXphdGlvblxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsLCBjb25maWcpID0+IHtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWwucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcikpO1xuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICAvLyBDaGVjayBpZiBidXR0b25FbGVtZW50IGV4aXN0c1xuICBpZiAoIWJ1dHRvbkVsZW1lbnQpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiU3VibWl0IGJ1dHRvbiBub3QgZm91bmQgaW4gZm9ybTpcIiwgZm9ybUVsKTtcbiAgICByZXR1cm47IC8vIEV4aXQgZWFybHkgaWYgdGhlIGJ1dHRvbiBpc24ndCBmb3VuZFxuICB9XG5cbiAgLy8gSW5pdGlhbGl6ZSBidXR0b24gc3RhdGUgYmFzZWQgb24gaW5wdXRzJyB2YWxpZGl0eVxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG5cbiAgLy8gQWRkIGV2ZW50IGxpc3RlbmVycyB0byBpbnB1dHNcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbi8vIEVuYWJsZSBGb3JtIFZhbGlkYXRpb25cbmV4cG9ydCBjb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xuICBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3Rvcik7XG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbCkgPT4ge1xuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbCwgY29uZmlnKTtcbiAgfSk7XG59O1xuIiwiY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yICR7cmVzLnN0YXR1c306ICR7cmVzLnN0YXR1c1RleHR9YCk7XG4gIH1cblxuICBnZXRBcHBJbmZvKCkge1xuICAgIC8vQ2FsbCBnZXRVc2VySW5mbyBpbiB0aGlzIGFycmF5XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgLy8gU2VuZCB0aGUgZGF0YSBpbiB0aGUgYm9keSBhcyBhIEpTT04gc3RyaW5nLlxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBhYm91dCxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBlZGl0VXNlckF2YXRhcih7IGF2YXRhciB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIC8vIFNlbmQgdGhlIGRhdGEgaW4gdGhlIGJvZHkgYXMgYSBKU09OIHN0cmluZy5cbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBjaGFuZ2VMaWtlU3RhdHVzKGlkLCBpc0xpa2VkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBpc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBlZGl0VXNlclBvc3QoeyBuYW1lLCBsaW5rIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIC8vIFNlbmQgdGhlIGRhdGEgaW4gdGhlIGJvZHkgYXMgYSBKU09OIHN0cmluZy5cbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgbGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQXBpO1xuIiwiZXhwb3J0IGZ1bmN0aW9uIHNldEJ1dHRvblRleHQoXG4gIGJ0bixcbiAgaXNMb2FkaW5nLFxuICBkZWZhdWx0VGV4dCA9IFwiU2F2ZVwiLFxuICBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCJcbikge1xuICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgYnRuLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XG4gIH0gZWxzZSB7XG4gICAgYnRuLnRleHRDb250ZW50ID0gZGVmYXVsdFRleHQ7XG4gIH1cbn1cbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQge1xuICBkaXNhYmxlQnV0dG9uLFxuICBlbmFibGVWYWxpZGF0aW9uLFxuICByZXNldFZhbGlkYXRpb24sXG4gIHNldHRpbmdzLFxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcbmltcG9ydCBsb2dvSWNvbiBmcm9tIFwiLi4vaW1hZ2VzL2xvZ28uc3ZnXCI7XG5pbXBvcnQgZWRpdFByb2ZpbGVJY29uIGZyb20gXCIuLi9pbWFnZXMvcGVuY2lsLnN2Z1wiO1xuaW1wb3J0IG5ld1Bvc3RJY29uIGZyb20gXCIuLi9pbWFnZXMvcGx1cy5zdmdcIjtcbmltcG9ydCBlZGl0TW9kYWxDbG9zZUljb24gZnJvbSBcIi4uL2ltYWdlcy9jbG9zZS5zdmdcIjtcbmltcG9ydCBuZXdNb2RhbENsb3NlSWNvbiBmcm9tIFwiLi4vaW1hZ2VzL2Nsb3NlLnN2Z1wiO1xuaW1wb3J0IGVkaXRBdmF0YXJJY29uIGZyb20gXCIuLi9pbWFnZXMvcGVuY2lsLWxpZ2h0LnN2Z1wiO1xuaW1wb3J0IGF2YXRhck1vZGFsQ2xvc2VJY29uIGZyb20gXCIuLi9pbWFnZXMvY2xvc2Uuc3ZnXCI7XG5pbXBvcnQgeyBzZXRCdXR0b25UZXh0IH0gZnJvbSBcIi4uL3V0aWxzL2hlbHBlcnMuanNcIjtcblxuY29uc3QgbG9nb0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImhlYWRlcl9fbG9nb1wiKTtcbmxvZ29FbGVtZW50LnNyYyA9IGxvZ29JY29uO1xuXG5jb25zdCBhdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlX19hdmF0YXJcIik7XG5cbmNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlX19lZGl0LWJ0bi1pY29uXCIpO1xuZWRpdFByb2ZpbGVCdXR0b24uc3JjID0gZWRpdFByb2ZpbGVJY29uO1xuXG5jb25zdCBuZXdQb3N0QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlX19hZGQtYnRuLWljb25cIik7XG5uZXdQb3N0QnV0dG9uLnNyYyA9IG5ld1Bvc3RJY29uO1xuXG5jb25zdCBlZGl0UHJvZmlsZU1vZGFsQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgXCJtb2RhbF9fY2xvc2UtYnRuLWljb25cIlxuKTtcbmVkaXRQcm9maWxlTW9kYWxDbG9zZUJ1dHRvbi5zcmMgPSBlZGl0TW9kYWxDbG9zZUljb247XG5cbmNvbnN0IGVkaXRQcm9maWxlQnV0dG9uTGlnaHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgXCJwcm9maWxlX19hdmF0YXItYnRuLWltZ1wiXG4pO1xuZWRpdFByb2ZpbGVCdXR0b25MaWdodC5zcmMgPSBlZGl0QXZhdGFySWNvbjtcblxuY29uc3QgbmV3UG9zdE1vZGFsQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgXCJtb2RhbF9fY2xvc2UtYnRuLWljb24tMlwiXG4pO1xubmV3UG9zdE1vZGFsQ2xvc2VCdXR0b24uc3JjID0gbmV3TW9kYWxDbG9zZUljb247XG5cbmNvbnN0IGF2YXRhck1vZGFsQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgXCJtb2RhbF9fY2xvc2UtYnRuLWljb24tM1wiXG4pO1xuXG5hdmF0YXJNb2RhbENsb3NlQnV0dG9uLnNyYyA9IGF2YXRhck1vZGFsQ2xvc2VJY29uO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCI5Y2IwMmRkYi1iZTkzLTRmNGQtYWNkNy1iZjU1ZDBhYzkwZjBcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5hcGlcbiAgLmdldEFwcEluZm8oKVxuICAudGhlbigoW2NhcmRzLCB1c2VyXSkgPT4ge1xuICAgIGNhcmRzLmZvckVhY2goKGNhcmQpID0+IHtcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoY2FyZCk7XG4gICAgICBjYXJkc0xpc3QucHJlcGVuZChjYXJkRWxlbWVudCk7XG4gICAgfSk7XG5cbiAgICBjb25zdCB7IG5hbWUsIGFib3V0LCBhdmF0YXIgfSA9IHVzZXI7XG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIGRlc2NyaXB0aW9uTmFtZS50ZXh0Q29udGVudCA9IGFib3V0O1xuICAgIGF2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGVycik7XG4gIH0pO1xuXG4vLyBQcm9maWxlIFNlY3Rpb24gRE9NIEVsZW1lbnRzXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idG5cIik7XG5jb25zdCBwcm9maWxlQWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnRuXCIpO1xuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5jb25zdCBkZXNjcmlwdGlvbk5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuXG4vLyBFZGl0IFByb2ZpbGUgTW9kYWwgRE9NIEVsZW1lbnRzXG5jb25zdCBlZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtbW9kYWxcIik7XG5jb25zdCBlZGl0Rm9ybSA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgZWRpdE1vZGFsTmFtZUlucHV0ID0gZWRpdEZvcm0uZWxlbWVudHNbXCJwcm9maWxlLW5hbWUtaW5wdXRcIl07XG5jb25zdCBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0ID1cbiAgZWRpdEZvcm0uZWxlbWVudHNbXCJwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJdO1xuY29uc3QgZWRpdEF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcblxuLy8gQWRkIENhcmQgTW9kYWwgRE9NIEVsZW1lbnRzXG5jb25zdCBjYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsXCIpO1xuY29uc3QgY2FyZEZvcm0gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGNhcmROYW1lSW5wdXQgPSBjYXJkRm9ybS5lbGVtZW50c1tcImFkZC1jYXJkLW5hbWUtaW5wdXRcIl07XG5jb25zdCBjYXJkTGlua0lucHV0ID0gY2FyZEZvcm0uZWxlbWVudHNbXCJhZGQtY2FyZC1saW5rLWlucHV0XCJdO1xuY29uc3QgY2FyZFN1Ym1pdEJ1dHRvbiA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xuXG4vLyBDYXJkcyBTZWN0aW9uIERPTSBFbGVtZW50c1xuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpO1xuY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcblxuLy8gUHJldmlldyBNb2RhbCBET00gRWxlbWVudHNcbmNvbnN0IHByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1tb2RhbFwiKTtcbmNvbnN0IHByZXZpZXdNb2RhbEltYWdlID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuY29uc3QgcHJldmlld01vZGFsQ2FwdGlvbiA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuXG4vL0F2YXRhciBNb2RhbCBET00gRWxlbWVudHNcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWxcIik7XG5jb25zdCBhdmF0YXJGb3JtID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGF2YXRhcklucHV0ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWF2YXRhci1pbnB1dFwiKTtcblxuLy9EZWxldGUgTW9kYWwgRE9NIEVsZW1lbnRzXG5jb25zdCBkZWxldGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLW1vZGFsXCIpO1xuY29uc3QgZGVsZXRlRm9ybSA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBkZWxldGVNb2RhbENhbmNlbEJ1dHRvbiA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19zdWJtaXQtYnRuX2NhbmNlbFwiXG4pO1xuXG4vL0RlbGV0ZSBDYXJkIFZhcmlhYmxlc1xubGV0IHNlbGVjdGVkQ2FyZCwgc2VsZWN0ZWRDYXJkSWQ7XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIE9wZW4gJiBDbG9zZSBNb2RhbCBGdW5jdGlvbnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGNsb3NlTW9kYWxPbkVzY2FwZSk7XG59XG5cbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VNb2RhbE9uRXNjYXBlKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlTGlrZShldnQsIGlkKSB7XG4gIGNvbnN0IGNhcmRMaWtlQnRuID0gZXZ0LnRhcmdldDtcbiAgY29uc3QgaXNMaWtlZCA9IGNhcmRMaWtlQnRuLmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpO1xuICBhcGlcbiAgICAuY2hhbmdlTGlrZVN0YXR1cyhpZCwgaXNMaWtlZClcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGhhbmRsaW5nIGxpa2U6XCIsIGVycik7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGNsb3NlTW9kYWxPbkVzY2FwZShldnQpIHtcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICBjb25zdCBvcGVuTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX29wZW5lZFwiKTtcbiAgICBpZiAob3Blbk1vZGFsKSB7XG4gICAgICBjbG9zZU1vZGFsKG9wZW5Nb2RhbCk7XG4gICAgfVxuICB9XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIENhcmQgQ3JlYXRpb24gJiBEZWxldGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgY29uc3QgY2FyZFRpdGxlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgY29uc3QgY2FyZEltZyA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gIGNvbnN0IGNhcmRMaWtlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ0blwiKTtcbiAgY29uc3QgY2FyZERlbGV0ZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ0blwiKTtcblxuICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gIGNhcmRJbWcuYWx0ID0gZGF0YS5uYW1lO1xuICBjYXJkSW1nLnNyYyA9IGRhdGEubGluaztcblxuICBpZiAoZGF0YS5pc0xpa2VkKSB7XG4gICAgY2FyZExpa2VCdG4uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpO1xuICB9XG5cbiAgY2FyZExpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICBoYW5kbGVMaWtlKGV2dCwgZGF0YS5faWQpO1xuICB9KTtcblxuICBjYXJkRGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YS5faWQpO1xuICB9KTtcblxuICBjYXJkSW1nLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgb3Blbk1vZGFsKHByZXZpZXdNb2RhbCk7XG4gICAgcHJldmlld01vZGFsSW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xuICAgIHByZXZpZXdNb2RhbEltYWdlLmFsdCA9IGRhdGEubmFtZTtcbiAgICBwcmV2aWV3TW9kYWxDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICB9KTtcblxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbmNvbnN0IGNsb3NlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcbmNsb3NlQnV0dG9ucy5mb3JFYWNoKChidXR0b24pID0+IHtcbiAgY29uc3QgcG9wdXAgPSBidXR0b24uY2xvc2VzdChcIi5tb2RhbFwiKTtcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKHBvcHVwKSk7XG59KTtcblxuY29uc3QgcG9wdXBzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbFwiKTtcbnBvcHVwcy5mb3JFYWNoKChwb3B1cCkgPT4ge1xuICBwb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcbiAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcbiAgICAgIGNsb3NlTW9kYWwocG9wdXApO1xuICAgIH1cbiAgfSk7XG59KTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gTW9kYWwgRm9ybSBIYW5kbGVyc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5mdW5jdGlvbiBoYW5kbGVFZGl0Rm9ybVN1Ym1pdChldnQpIHtcbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZXZ0LnN1Ym1pdHRlcjtcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdXR0b24sIHRydWUpO1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgYXBpXG4gICAgLmVkaXRVc2VySW5mbyh7XG4gICAgICBuYW1lOiBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWUsXG4gICAgICBhYm91dDogZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZSxcbiAgICB9KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICAgIGRlc2NyaXB0aW9uTmFtZS50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XG4gICAgICBjbG9zZU1vZGFsKGVkaXRNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ1dHRvbiwgZmFsc2UpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZXZ0LnN1Ym1pdHRlcjtcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdXR0b24sIHRydWUpO1xuICBjb25zdCBpbnB1dFZhbHVlcyA9IHsgbmFtZTogY2FyZE5hbWVJbnB1dC52YWx1ZSwgbGluazogY2FyZExpbmtJbnB1dC52YWx1ZSB9O1xuICBhcGlcbiAgICAuZWRpdFVzZXJQb3N0KGlucHV0VmFsdWVzKVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGRhdGEpO1xuICAgICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xuICAgICAgY2xvc2VNb2RhbChjYXJkTW9kYWwpO1xuICAgICAgY2FyZEZvcm0ucmVzZXQoKTtcbiAgICAgIGRpc2FibGVCdXR0b24oY2FyZFN1Ym1pdEJ1dHRvbiwgc2V0dGluZ3MpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdXR0b24sIGZhbHNlKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGV2dC5zdWJtaXR0ZXI7XG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnV0dG9uLCB0cnVlKTtcbiAgYXBpXG4gICAgLmVkaXRVc2VyQXZhdGFyKHtcbiAgICAgIGF2YXRhcjogYXZhdGFySW5wdXQudmFsdWUsXG4gICAgfSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgYXZhdGFyRWxlbWVudC5zcmMgPSBkYXRhLmF2YXRhcjtcbiAgICAgIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdXR0b24sIGZhbHNlKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlU3VibWl0KGV2dCkge1xuICBjb25zdCBkZWxldGVCdXR0b24gPSBldnQuc3VibWl0dGVyO1xuICBzZXRCdXR0b25UZXh0KGRlbGV0ZUJ1dHRvbiwgdHJ1ZSwgXCJEZWxldGVcIiwgXCJEZWxldGluZy4uLlwiKTtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGFwaVxuICAgIC5kZWxldGVDYXJkKHNlbGVjdGVkQ2FyZElkKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIHNlbGVjdGVkQ2FyZC5yZW1vdmUoKTtcbiAgICAgIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dChkZWxldGVCdXR0b24sIGZhbHNlLCBcIkRlbGV0ZVwiLCBcIkRlbGV0aW5nLi4uXCIpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBjYXJkSWQpIHtcbiAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XG4gIHNlbGVjdGVkQ2FyZElkID0gY2FyZElkO1xuICBvcGVuTW9kYWwoZGVsZXRlTW9kYWwpO1xufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBFdmVudCBMaXN0ZW5lcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZWRpdE1vZGFsTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XG4gIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBkZXNjcmlwdGlvbk5hbWUudGV4dENvbnRlbnQ7XG4gIG9wZW5Nb2RhbChlZGl0TW9kYWwpO1xuICByZXNldFZhbGlkYXRpb24oXG4gICAgZWRpdEZvcm0sXG4gICAgW2VkaXRNb2RhbE5hbWVJbnB1dCwgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dF0sXG4gICAgc2V0dGluZ3NcbiAgKTtcbn0pO1xuXG5wcm9maWxlQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChjYXJkTW9kYWwpO1xufSk7XG5cbmVkaXRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRWRpdEZvcm1TdWJtaXQpO1xuY2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcblxuZWRpdEF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xufSk7XG5cbmF2YXRhckZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBdmF0YXJTdWJtaXQpO1xuXG5kZWxldGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRGVsZXRlU3VibWl0KTtcblxuZGVsZXRlTW9kYWxDYW5jZWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XG59KTtcblxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbCIsImlucHV0RWwiLCJjb25maWciLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJ0ZXh0Q29udGVudCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0IiwiYnV0dG9uRWwiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsImVuYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiYWRkIiwic2V0QnV0dG9uVGV4dCIsImJ0biIsImlzTG9hZGluZyIsImRlZmF1bHRUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwibG9hZGluZ1RleHQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwic3JjIiwibG9nb0ljb24iLCJhdmF0YXJFbGVtZW50IiwiZWRpdFByb2ZpbGVJY29uIiwibmV3UG9zdEljb24iLCJlZGl0TW9kYWxDbG9zZUljb24iLCJlZGl0QXZhdGFySWNvbiIsIm5ld01vZGFsQ2xvc2VJY29uIiwiYXZhdGFyTW9kYWxDbG9zZUljb24iLCJhcGkiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJiYXNlVXJsIiwiaGVhZGVycyIsInRoaXMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwic3RhdHVzVGV4dCIsImdldEFwcEluZm8iLCJhbGwiLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsImVkaXRVc2VySW5mbyIsIl9yZWYyIiwibmFtZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlZGl0VXNlckF2YXRhciIsIl9yZWYzIiwiYXZhdGFyIiwiZGVsZXRlQ2FyZCIsImNoYW5nZUxpa2VTdGF0dXMiLCJpc0xpa2VkIiwiZWRpdFVzZXJQb3N0IiwiX3JlZjQiLCJsaW5rIiwiYXV0aG9yaXphdGlvbiIsImNhcmRzIiwidXNlciIsImZvckVhY2giLCJjYXJkIiwiY2FyZEVsZW1lbnQiLCJnZXRDYXJkRWxlbWVudCIsImNhcmRzTGlzdCIsInByZXBlbmQiLCJwcm9maWxlTmFtZSIsImRlc2NyaXB0aW9uTmFtZSIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUFkZEJ1dHRvbiIsImVkaXRNb2RhbCIsImVkaXRGb3JtIiwiZWRpdE1vZGFsTmFtZUlucHV0IiwiZWxlbWVudHMiLCJlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0IiwiZWRpdEF2YXRhckJ1dHRvbiIsImNhcmRNb2RhbCIsImNhcmRGb3JtIiwiY2FyZE5hbWVJbnB1dCIsImNhcmRMaW5rSW5wdXQiLCJjYXJkU3VibWl0QnV0dG9uIiwiY2FyZFRlbXBsYXRlIiwicHJldmlld01vZGFsIiwicHJldmlld01vZGFsSW1hZ2UiLCJwcmV2aWV3TW9kYWxDYXB0aW9uIiwiYXZhdGFyTW9kYWwiLCJhdmF0YXJGb3JtIiwiYXZhdGFySW5wdXQiLCJkZWxldGVNb2RhbCIsImRlbGV0ZUZvcm0iLCJkZWxldGVNb2RhbENhbmNlbEJ1dHRvbiIsInNlbGVjdGVkQ2FyZCIsInNlbGVjdGVkQ2FyZElkIiwib3Blbk1vZGFsIiwibW9kYWwiLCJhZGRFdmVudExpc3RlbmVyIiwiY2xvc2VNb2RhbE9uRXNjYXBlIiwiY2xvc2VNb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJkYXRhIiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmRUaXRsZSIsImNhcmRJbWciLCJjYXJkTGlrZUJ0biIsImNhcmREZWxldGVCdG4iLCJhbHQiLCJ0YXJnZXQiLCJjb250YWlucyIsInRvZ2dsZSIsImVycm9yIiwiaGFuZGxlTGlrZSIsIl9pZCIsImNhcmRJZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiYnV0dG9uIiwicG9wdXAiLCJjbG9zZXN0IiwicmVzZXRWYWxpZGF0aW9uIiwidmFsdWUiLCJzdWJtaXRCdXR0b24iLCJzdWJtaXR0ZXIiLCJwcmV2ZW50RGVmYXVsdCIsImZpbmFsbHkiLCJpbnB1dFZhbHVlcyIsInJlc2V0IiwiZGVsZXRlQnV0dG9uIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJBcnJheSIsImZyb20iLCJidXR0b25FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1zZyIsInZhbGlkYXRpb25NZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==